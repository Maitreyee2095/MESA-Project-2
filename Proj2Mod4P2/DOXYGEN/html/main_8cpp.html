<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project2Mod4Part2: main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project2Mod4Part2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('main_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">main.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;mbed.h&quot;</code><br />
<code>#include &quot;arm_math.h&quot;</code><br />
<code>#include &quot;arm_common_tables.h&quot;</code><br />
<code>#include &quot;arm_const_structs.h&quot;</code><br />
<code>#include &quot;math_helper.h&quot;</code><br />
<code>#include &lt;time.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6b20d41d6252e9871430c242cb1a56e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a6b20d41d6252e9871430c242cb1a56e7">BUFFER_SIZE</a>&#160;&#160;&#160;(4096)</td></tr>
<tr class="separator:a6b20d41d6252e9871430c242cb1a56e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b76a0c2859cfd819a343a780070ee2b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a4b76a0c2859cfd819a343a780070ee2b">SAMPLE_RATE</a>&#160;&#160;&#160;(44100)</td></tr>
<tr class="separator:a4b76a0c2859cfd819a343a780070ee2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2242fccb813a33d93998482592f1cf79"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a2242fccb813a33d93998482592f1cf79">ONE_SECOND_US</a>&#160;&#160;&#160;1000000.0</td></tr>
<tr class="separator:a2242fccb813a33d93998482592f1cf79"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a81e0624d7e9f10f8f7e52a569ba24753"><td class="memItemLeft" align="right" valign="top">Serial&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a81e0624d7e9f10f8f7e52a569ba24753">pc</a> (USBTX, USBRX)</td></tr>
<tr class="separator:a81e0624d7e9f10f8f7e52a569ba24753"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b9ddc13d467ce4d6129164bf7fe9b96"><td class="memItemLeft" align="right" valign="top">AnalogIn&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a2b9ddc13d467ce4d6129164bf7fe9b96">signal</a> (PA_0)</td></tr>
<tr class="separator:a2b9ddc13d467ce4d6129164bf7fe9b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74af47498361779e8a93a5c7308085a7"><td class="memItemLeft" align="right" valign="top">PwmOut&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a74af47498361779e8a93a5c7308085a7">myLED</a> (PA_5)</td></tr>
<tr class="separator:a74af47498361779e8a93a5c7308085a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50a2ce599e896bfb535e70a42003ed23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a50a2ce599e896bfb535e70a42003ed23">sample</a> ()</td></tr>
<tr class="memdesc:a50a2ce599e896bfb535e70a42003ed23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for sampling the ADC input "signal".  <a href="main_8cpp.html#a50a2ce599e896bfb535e70a42003ed23">More...</a><br /></td></tr>
<tr class="separator:a50a2ce599e896bfb535e70a42003ed23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e436bc2acb854affcce7501b760fa6d"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a3e436bc2acb854affcce7501b760fa6d">getFundamentalFreq</a> ()</td></tr>
<tr class="memdesc:a3e436bc2acb854affcce7501b760fa6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function obtaining the fundamental frequency from the sample buffer.  <a href="main_8cpp.html#a3e436bc2acb854affcce7501b760fa6d">More...</a><br /></td></tr>
<tr class="separator:a3e436bc2acb854affcce7501b760fa6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="memdesc:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function.  <a href="main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">More...</a><br /></td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><hr  />
<hr  />
 <h1><a class="anchor" id="autotoc_md0"></a>
ECEN 5803 Mastering Embedded System Architecture</h1>
<h2><a class="anchor" id="autotoc_md1"></a>
Project 2 Module 4 Part 2</h2>
<h2><a class="anchor" id="autotoc_md2"></a>
Signal Analyzer Firmware - Harmonic Analysis</h2>
<h2><a class="anchor" id="autotoc_md3"></a>
main.cpp</h2>
<h2><a class="anchor" id="autotoc_md4"></a>
Designed for:  University of Colorado at Boulder</h2>
<h2><a class="anchor" id="autotoc_md5"></a>
Designed by:  Erich Clever &amp; Maitreyee Rao</h2>
<h2><a class="anchor" id="autotoc_md6"></a>
Version: 1.0</h2>
<h2><a class="anchor" id="autotoc_md7"></a>
Date of current revision:  2021-10-21</h2>
<h2><a class="anchor" id="autotoc_md8"></a>
Target Microcontroller: STM23F401RE</h2>
<h2><a class="anchor" id="autotoc_md9"></a>
Tools used:</h2>
<ul>
<li>ARM mbed compiler</li>
<li>ARM mbed SDK</li>
<li>ARM CMSIS DSP API</li>
<li>ST Nucleo-F401RE</li>
<li>Analog Discover 2 - Oscilloscope and function generation</li>
</ul>
<h2><a class="anchor" id="autotoc_md10"></a>
Functional Description:</h2>
<p >Samples of an analog signal are read using the 12-bit ADC included in the microcontroller, then harmonic analysis is performed to determine the fundamental frequency of this signal. An FFT algorithm included in the CMSIS DSP library is used to do this. The User LED (LD2) blinks at a rate proportional to the measured fundamental frequency. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6b20d41d6252e9871430c242cb1a56e7" name="a6b20d41d6252e9871430c242cb1a56e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b20d41d6252e9871430c242cb1a56e7">&#9670;&nbsp;</a></span>BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUFFER_SIZE&#160;&#160;&#160;(4096)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2242fccb813a33d93998482592f1cf79" name="a2242fccb813a33d93998482592f1cf79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2242fccb813a33d93998482592f1cf79">&#9670;&nbsp;</a></span>ONE_SECOND_US</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ONE_SECOND_US&#160;&#160;&#160;1000000.0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4b76a0c2859cfd819a343a780070ee2b" name="a4b76a0c2859cfd819a343a780070ee2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b76a0c2859cfd819a343a780070ee2b">&#9670;&nbsp;</a></span>SAMPLE_RATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SAMPLE_RATE&#160;&#160;&#160;(44100)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3e436bc2acb854affcce7501b760fa6d" name="a3e436bc2acb854affcce7501b760fa6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e436bc2acb854affcce7501b760fa6d">&#9670;&nbsp;</a></span>getFundamentalFreq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t getFundamentalFreq </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function obtaining the fundamental frequency from the sample buffer. </p>
<p >This function determiens the fundamental frequency of the measured signal by performing complex FFT algorithms on the data buffer then finding the bin with the largest magnitude.</p>
<dl class="section return"><dt>Returns</dt><dd>The fundamental frequency of the signal </dd></dl>

</div>
</div>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4" name="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function. </p>
<p >This function executes the firmware for a signal analyzer by executing the following steps in a loop: -ADC sampling into a data buffer -FFT on data buffer to determine the fundamental frequency -Display over UART of determined fundamental frequency and blinking of User LED at that frequency </p>

</div>
</div>
<a id="a74af47498361779e8a93a5c7308085a7" name="a74af47498361779e8a93a5c7308085a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74af47498361779e8a93a5c7308085a7">&#9670;&nbsp;</a></span>myLED()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PwmOut myLED </td>
          <td>(</td>
          <td class="paramtype">PA_5&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a81e0624d7e9f10f8f7e52a569ba24753" name="a81e0624d7e9f10f8f7e52a569ba24753"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e0624d7e9f10f8f7e52a569ba24753">&#9670;&nbsp;</a></span>pc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Serial pc </td>
          <td>(</td>
          <td class="paramtype">USBTX&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">USBRX&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a50a2ce599e896bfb535e70a42003ed23" name="a50a2ce599e896bfb535e70a42003ed23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50a2ce599e896bfb535e70a42003ed23">&#9670;&nbsp;</a></span>sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sample </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for sampling the ADC input "signal". </p>
<p >This function creates a buffer of sample data for input into a complex FFT function. </p>

</div>
</div>
<a id="a2b9ddc13d467ce4d6129164bf7fe9b96" name="a2b9ddc13d467ce4d6129164bf7fe9b96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b9ddc13d467ce4d6129164bf7fe9b96">&#9670;&nbsp;</a></span>signal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AnalogIn signal </td>
          <td>(</td>
          <td class="paramtype">PA_0&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
